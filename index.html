// =============================================
// ğŸ”¥ ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
// =============================================

let currentStoreId = null;
let selectedAccountType = null;

// Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
async function handleLogin(event) {
    if (event) event.preventDefault();
    
    if (isLoading) return false;
    
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    const loginBtn = document.getElementById('loginBtn');
    const loginBtnText = document.getElementById('loginBtnText');
    
    if (!email || !password) {
        showSuccess('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'âš ï¸ Ø§Ù†ØªØ¨Ù‡');
        return false;
    }
    
    try {
        // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        isLoading = true;
        loginBtn.disabled = true;
        loginBtnText.innerHTML = '<i class="fas fa-spinner fa-spin ml-2"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„...';
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        const userCredential = await auth.signInWithEmailAndPassword(email, password);
        currentUser = userCredential.user;
        
        // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        const userDoc = await db.collection('users').doc(currentUser.uid).get();
        if (userDoc.exists) {
            const userData = userDoc.data();
            currentUserRole = userData.role || 'buyer';
            currentUserAccountType = userData.accountType || 'buyer';
            
            // ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
            await db.collection('users').doc(currentUser.uid).update({
                lastLogin: new Date().toISOString()
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
            showSuccess(
                `Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ ${userData.name || currentUser.email.split('@')[0]}!`,
                'ğŸ‰ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
                () => {
                    closeModal('loginModal');
                    updateUIAfterLogin();
                    redirectAfterLogin();
                }
            );
            
        } else {
            throw new Error('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
        }
        
    } catch (error) {
        console.error('Login error:', error);
        showSuccess(getFirebaseErrorMessage(error.code), 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„');
    } finally {
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        setTimeout(() => {
            isLoading = false;
            if (loginBtn) {
                loginBtn.disabled = false;
                loginBtnText.textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
            }
        }, 1000);
    }
    
    return false;
}

// Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
async function handleRegister(event) {
    if (event) event.preventDefault();
    
    if (isLoading) return false;
    
    const name = document.getElementById('registerName').value;
    const email = document.getElementById('registerEmail').value;
    const password = document.getElementById('registerPassword').value;
    const terms = document.getElementById('registerTerms').checked;
    
    if (!name || !email || !password) {
        showSuccess('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'âš ï¸ Ø§Ù†ØªØ¨Ù‡');
        return false;
    }
    
    if (!terms) {
        showSuccess('ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…', 'âš ï¸ Ø§Ù†ØªØ¨Ù‡');
        return false;
    }
    
    if (password.length < 6) {
        showSuccess('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'âš ï¸ Ø§Ù†ØªØ¨Ù‡');
        return false;
    }
    
    try {
        // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        isLoading = true;
        const registerBtn = document.getElementById('registerBtn');
        const registerBtnText = document.getElementById('registerBtnText');
        if (registerBtn && registerBtnText) {
            registerBtn.disabled = true;
            registerBtnText.innerHTML = '<i class="fas fa-spinner fa-spin ml-2"></i> Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨...';
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ ÙÙŠ Firebase
        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
        currentUser = userCredential.user;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù…
        await currentUser.updateProfile({ displayName: name });
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨
        closeModal('registerModal');
        setTimeout(() => {
            showAccountTypeModal();
        }, 500);
        
    } catch (error) {
        console.error('Register error:', error);
        showSuccess(getFirebaseErrorMessage(error.code), 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„');
    } finally {
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        setTimeout(() => {
            isLoading = false;
            const registerBtn = document.getElementById('registerBtn');
            const registerBtnText = document.getElementById('registerBtnText');
            if (registerBtn && registerBtnText) {
                registerBtn.disabled = false;
                registerBtnText.textContent = 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨';
            }
        }, 1000);
    }
    
    return false;
}

// Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¹Ø¨Ø± Ø¬ÙˆØ¬Ù„ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
async function loginWithGoogle() {
    if (isLoading) return;
    
    try {
        isLoading = true;
        const provider = new firebase.auth.GoogleAuthProvider();
        
        showLoading('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø­Ø³Ø§Ø¨ Ø¬ÙˆØ¬Ù„...');
        
        const result = await auth.signInWithPopup(provider);
        currentUser = result.user;
        
        const userDoc = await db.collection('users').doc(currentUser.uid).get();
        
        if (!userDoc.exists) {
            // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
            closeAllModals();
            setTimeout(() => {
                showAccountTypeModal();
            }, 500);
        } else {
            // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
            const userData = userDoc.data();
            currentUserRole = userData.role || 'buyer';
            currentUserAccountType = userData.accountType || 'buyer';
            
            // ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
            await db.collection('users').doc(currentUser.uid).update({
                lastLogin: new Date().toISOString()
            });
            
            showSuccess(
                `Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒ ${currentUser.displayName || currentUser.email.split('@')[0]}!`,
                'ğŸ‰ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
                () => {
                    closeAllModals();
                    updateUIAfterLogin();
                    redirectAfterLogin();
                }
            );
        }
        
    } catch (error) {
        console.error('Google login error:', error);
        showSuccess(getFirebaseErrorMessage(error.code), 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„');
    } finally {
        isLoading = false;
    }
}

function registerWithGoogle() {
    loginWithGoogle();
}

// ØªÙˆØ¬ÙŠÙ‡ Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
function redirectAfterLogin() {
    if (!currentUser) return;
    
    setTimeout(() => {
        if (currentUserAccountType === 'seller') {
            // ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙ‡ Ù…ØªØ§Ø¬Ø±
            checkUserStores();
        } else if (currentUserAccountType === 'buyer') {
            // ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
            navigateTo('mainStore');
            loadMainStoreProducts();
            showSuccess(
                'ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØµÙØ­ ÙˆØ´Ø±Ø§Ø¡ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Ù…ØªØ¬Ø± Ø§Ù„Ù…Ù†ØµØ©',
                'ğŸ›’ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…ØªØ¬Ø± Ø§Ù„Ù…Ù†ØµØ©'
            );
        }
    }, 800);
}

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…ØªØ§Ø¬Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
async function checkUserStores() {
    try {
        const storesSnapshot = await db.collection('stores')
            .where('ownerId', '==', currentUser.uid)
            .where('isActive', '==', true)
            .get();
        
        if (storesSnapshot.empty) {
            // Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ØªØ§Ø¬Ø±ØŒ Ø§Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¥Ù†Ø´Ø§Ø¡ Ù…ØªØ¬Ø±
            setTimeout(() => {
                showCreateStoreModal();
                showSuccess(
                    'Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù…ØªØ¬Ø±Ùƒ Ø§Ù„Ø£ÙˆÙ„',
                    'ğŸš€ Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ø¨Ø§Ø¦Ø¹!',
                    null,
                    5000
                );
            }, 1000);
        } else {
            // Ù„Ø¯ÙŠÙ‡ Ù…ØªØ§Ø¬Ø±ØŒ ØªÙˆØ¬ÙŠÙ‡ Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØ§Ø¬Ø±
            navigateTo('stores');
            loadStores();
            showSuccess(
                'ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¥Ø¯Ø§Ø±Ø© Ù…ØªØ§Ø¬Ø±Ùƒ ÙˆØ¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©',
                'ğŸª Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†'
            );
        }
    } catch (error) {
        console.error('Error checking stores:', error);
        navigateTo('stores');
    }
}

// =============================================
// ğŸš€ Ø¥Ù†Ø´Ø§Ø¡ Ù…ØªØ¬Ø± Ù…Ø­Ø³Ù†
// =============================================

async function handleCreateStore(event) {
    if (event) event.preventDefault();
    
    if (!currentUser) {
        showSuccess('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'âš ï¸ Ø§Ù†ØªØ¨Ù‡');
        showLoginModal();
        return false;
    }
    
    if (currentUserAccountType !== 'seller') {
        showSuccess('Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù…ØªØ§Ø­Ø© ÙÙ‚Ø· Ù„Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†', 'âš ï¸ Ø§Ù†ØªØ¨Ù‡');
        return false;
    }
    
    const storeName = document.getElementById('storeName').value;
    const storeCategory = document.getElementById('storeCategory').value;
    const storeDescription = document.getElementById('storeDescription').value;
    
    if (!storeName) {
        showSuccess('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±', 'âš ï¸ Ø§Ù†ØªØ¨Ù‡');
        return false;
    }
    
    try {
        // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        const createStoreBtn = document.getElementById('createStoreBtn');
        const createStoreBtnText = document.getElementById('createStoreBtnText');
        if (createStoreBtn && createStoreBtnText) {
            createStoreBtn.disabled = true;
            createStoreBtnText.innerHTML = '<i class="fas fa-spinner fa-spin ml-2"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡...';
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø§Ù‚Ø©
        const userDoc = await db.collection('users').doc(currentUser.uid).get();
        const userData = userDoc.data();
        
        let maxStores = 1;
        if (userData.plan === 'basic') maxStores = 1;
        else if (userData.plan === 'premium') maxStores = 5;
        
        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ØªØ§Ø¬Ø± Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        const storesSnapshot = await db.collection('stores')
            .where('ownerId', '==', currentUser.uid)
            .where('isActive', '==', true)
            .get();
        
        if (storesSnapshot.size >= maxStores) {
            showSuccess(
                `Ù„Ù‚Ø¯ ÙˆØµÙ„Øª Ù„Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ (${maxStores}) ÙÙŠ Ø¨Ø§Ù‚Ø§ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©`,
                'ğŸ“Š ØªØ±Ù‚ÙŠØ© Ø§Ù„Ø¨Ø§Ù‚Ø©',
                () => {
                    closeModal('createStoreModal');
                    navigateTo('plans');
                }
            );
            return false;
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· ÙØ±ÙŠØ¯ Ù„Ù„Ù…ØªØ¬Ø±
        const storeSlug = generateStoreSlug(storeName);
        const storeUrl = `${window.location.origin}/store/${storeSlug}`;
        
        const storeData = {
            name: storeName,
            category: storeCategory,
            description: storeDescription,
            ownerId: currentUser.uid,
            ownerName: currentUser.displayName || currentUser.email.split('@')[0],
            ownerEmail: currentUser.email,
            createdAt: new Date().toISOString(),
            productsCount: 0,
            salesCount: 0,
            totalRevenue: 0,
            rating: 0,
            status: 'active',
            storeSlug: storeSlug,
            storeUrl: storeUrl,
            lastUpdated: new Date().toISOString(),
            isActive: true,
            plan: userData.plan || 'free',
            storeLogo: getDefaultStoreLogo(storeCategory)
        };
        
        const storeRef = await db.collection('stores').add(storeData);
        const storeId = storeRef.id;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØ¬Ø± Ø¨Ø§Ù„Ù€ ID
        await db.collection('stores').doc(storeId).update({
            id: storeId
        });
        
        // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ù…ØªØ§Ø¬Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        await db.collection('users').doc(currentUser.uid).update({
            storesCount: firebase.firestore.FieldValue.increment(1)
        });
        
        // Ø­ÙØ¸ Ø³Ø¬Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ØªØ¬Ø±
        await db.collection('store_logs').add({
            storeId: storeId,
            action: 'create',
            userId: currentUser.uid,
            timestamp: new Date().toISOString(),
            details: {
                name: storeName,
                category: storeCategory
            }
        });
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
        showSuccess(
            `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…ØªØ¬Ø± "${storeName}" Ø¨Ù†Ø¬Ø§Ø­!`,
            'ğŸ‰ Ù…ØªØ¬Ø± Ø¬Ø¯ÙŠØ¯',
            () => {
                closeModal('createStoreModal');
                currentStoreId = storeId;
                setTimeout(() => {
                    showStoreDetailsModal(storeId);
                    loadStores();
                }, 500);
            }
        );
        
    } catch (error) {
        console.error('Error creating store:', error);
        showSuccess('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ØªØ¬Ø±', 'âŒ Ø®Ø·Ø£');
    } finally {
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        setTimeout(() => {
            const createStoreBtn = document.getElementById('createStoreBtn');
            const createStoreBtnText = document.getElementById('createStoreBtnText');
            if (createStoreBtn && createStoreBtnText) {
                createStoreBtn.disabled = false;
                createStoreBtnText.textContent = 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ØªØ¬Ø±';
            }
        }, 1000);
    }
    
    return false;
}

// =============================================
// ğŸŒŸ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ø³Ù†Ø©
// =============================================

function updateUIAfterLogin() {
    const authButtons = document.getElementById('authButtons');
    if (!authButtons) return;
    
    const userName = currentUser.displayName || currentUser.email.split('@')[0];
    const userInitial = userName.charAt(0).toUpperCase();
    
    let badgeColor = '';
    let badgeText = '';
    let icon = '';
    
    if (currentUserRole === 'admin') {
        badgeColor = 'admin-badge';
        badgeText = 'Ù…Ø¯ÙŠØ±';
        icon = 'fa-crown';
    } else if (currentUserAccountType === 'seller') {
        badgeColor = 'seller-badge';
        badgeText = 'Ø¨Ø§Ø¦Ø¹';
        icon = 'fa-store';
    } else {
        badgeColor = 'buyer-badge';
        badgeText = 'Ù…Ø´ØªØ±ÙŠ';
        icon = 'fa-shopping-cart';
    }
    
    authButtons.innerHTML = `
        <div class="flex items-center space-x-3 space-x-reverse">
            ${currentUserRole === 'admin' ? `
                <button onclick="showAdminPanelModal()" 
                        class="btn-warning text-white px-6 py-2 rounded-lg font-medium hover:scale-105 transition-transform">
                    <i class="fas fa-cogs ml-2"></i>
                    Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                </button>
            ` : ''}
            
            ${currentUserAccountType === 'seller' ? `
                <button onclick="showUserDashboard()" 
                        class="btn-primary text-white px-6 py-2 rounded-lg font-medium hover:scale-105 transition-transform">
                    <i class="fas fa-chart-line ml-2"></i>
                    Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                </button>
            ` : ''}
            
            <div class="relative group">
                <button onclick="toggleUserMenu()" 
                        class="flex items-center space-x-2 space-x-reverse px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors">
                    <div class="w-8 h-8 ${badgeColor} rounded-full flex items-center justify-center text-white font-bold">
                        ${userInitial}
                    </div>
                    <div class="text-right">
                        <div class="font-medium text-dark text-sm">${userName}</div>
                        <div class="text-xs text-gray-500">${badgeText}</div>
                    </div>
                    <i class="fas fa-chevron-down text-gray-500"></i>
                </button>
                
                <div id="userMenu" class="absolute left-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 hidden group-hover:block z-50">
                    <div class="p-3 border-b border-gray-100">
                        <div class="font-medium text-dark">${userName}</div>
                        <div class="text-xs text-gray-500">${currentUser.email}</div>
                    </div>
                    <div class="py-1">
                        <a href="#" onclick="showAccountSettingsModal()" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-user-cog ml-2"></i>
                            Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨
                        </a>
                        ${currentUserAccountType === 'seller' ? `
                            <a href="#" onclick="showCreateStoreModal()" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                                <i class="fas fa-plus ml-2"></i>
                                Ø¥Ù†Ø´Ø§Ø¡ Ù…ØªØ¬Ø± Ø¬Ø¯ÙŠØ¯
                            </a>
                        ` : ''}
                        <a href="#" onclick="logout()" class="block px-4 py-2 text-red-600 hover:bg-red-50">
                            <i class="fas fa-sign-out-alt ml-2"></i>
                            ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                        </a>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function toggleUserMenu() {
    const menu = document.getElementById('userMenu');
    if (menu) {
        menu.classList.toggle('hidden');
    }
}

// Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
document.addEventListener('click', function(event) {
    const userMenu = document.getElementById('userMenu');
    const authButtons = document.getElementById('authButtons');
    
    if (userMenu && !userMenu.contains(event.target) && 
        authButtons && !authButtons.contains(event.target)) {
        userMenu.classList.add('hidden');
    }
});

// =============================================
// ğŸ“Š ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø³Ù†
// =============================================

async function loadStores() {
    const container = document.getElementById('storesContainer');
    if (!container) return;
    
    try {
        container.innerHTML = `
            <div class="col-span-3 text-center py-12">
                <div class="w-16 h-16 mx-auto mb-4">
                    <i class="fas fa-store text-4xl text-primary animate-pulse"></i>
                </div>
                <p class="text-gray-600">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØ§Ø¬Ø±...</p>
            </div>
        `;
        
        const querySnapshot = await db.collection('stores')
            .where('isActive', '==', true)
            .orderBy('createdAt', 'desc')
            .limit(12)
            .get();
        
        if (querySnapshot.empty) {
            container.innerHTML = `
                <div class="col-span-3 text-center py-16">
                    <div class="w-24 h-24 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-store text-3xl text-gray-400"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-700 mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØªØ§Ø¬Ø± Ø¨Ø¹Ø¯</h3>
                    <p class="text-gray-500 mb-6">ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠÙ†Ø´Ø¦ Ù…ØªØ¬Ø±Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØµØ©</p>
                    ${currentUser && currentUserAccountType === 'seller' ? `
                        <button onclick="showCreateStoreModal()" 
                                class="btn-primary text-white px-8 py-3 rounded-xl hover:scale-105 transition-transform">
                            <i class="fas fa-plus ml-2"></i>
                            Ø£Ù†Ø´Ø¦ Ø£ÙˆÙ„ Ù…ØªØ¬Ø± Ù„Ùƒ
                        </button>
                    ` : `
                        <button onclick="showRegisterModal()" 
                                class="btn-primary text-white px-8 py-3 rounded-xl hover:scale-105 transition-transform">
                            <i class="fas fa-user-plus ml-2"></i>
                            Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù† ÙˆØ£Ù†Ø´Ø¦ Ù…ØªØ¬Ø±Ùƒ
                        </button>
                    `}
                </div>
            `;
            return;
        }
        
        let storesHTML = '';
        querySnapshot.forEach(doc => {
            const store = doc.data();
            const storeId = doc.id;
            
            const categoryIcon = getCategoryIcon(store.category);
            const categoryName = getCategoryName(store.category);
            
            storesHTML += `
                <div class="store-card bg-white rounded-2xl shadow-lg overflow-hidden transform transition-all duration-300 hover:-translate-y-2">
                    <div class="relative">
                        <div class="h-40 bg-gradient-to-r ${getStoreGradient(store.category)} flex items-center justify-center">
                            <i class="fas ${categoryIcon} text-white text-5xl opacity-30"></i>
                        </div>
                        ${store.ownerId === currentUser?.uid ? `
                            <div class="absolute top-3 left-3">
                                <span class="bg-blue-100 text-blue-600 text-xs font-bold px-3 py-1 rounded-full">
                                    Ù…ØªØ¬Ø±ÙŠ
                                </span>
                            </div>
                        ` : ''}
                    </div>
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-xl font-bold text-dark mb-1">${store.name}</h3>
                                <div class="flex items-center text-gray-500 text-sm">
                                    <i class="fas ${categoryIcon} ml-1"></i>
                                    <span>${categoryName}</span>
                                </div>
                            </div>
                            <span class="bg-gray-100 text-gray-700 text-sm px-3 py-1 rounded-full">
                                ${store.plan === 'premium' ? 'Ù…Ù…ÙŠØ²' : 'Ø¹Ø§Ø¯ÙŠ'}
                            </span>
                        </div>
                        
                        <p class="text-gray-600 mb-6 line-clamp-2">${store.description || 'Ù…ØªØ¬Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¹Ù„Ù‰ Ù…Ù†ØµØ© Ù…ØªØ§Ø¬Ø±'}</p>
                        
                        <div class="flex justify-between items-center mb-6">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-primary">${store.productsCount || 0}</div>
                                <div class="text-xs text-gray-500">Ù…Ù†ØªØ¬</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-green-600">${store.salesCount || 0}</div>
                                <div class="text-xs text-gray-500">Ù…Ø¨ÙŠØ¹</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-yellow-600">${store.rating || 0}</div>
                                <div class="text-xs text-gray-500">ØªÙ‚ÙŠÙŠÙ…</div>
                            </div>
                        </div>
                        
                        <div class="space-y-3">
                            <button onclick="showStorePage('${storeId}')" 
                                    class="w-full btn-primary text-white py-3 rounded-xl hover:scale-105 transition-transform">
                                <i class="fas fa-external-link-alt ml-2"></i>
                                Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…ØªØ¬Ø±
                            </button>
                            ${currentUser && currentUser.uid === store.ownerId ? `
                                <button onclick="showStoreDetailsModal('${storeId}')" 
                                        class="w-full border-2 border-primary text-primary py-3 rounded-xl hover:bg-primary hover:text-white transition-colors">
                                    <i class="fas fa-chart-bar ml-2"></i>
                                    Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªØ¬Ø±
                                </button>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = storesHTML;
        
        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„ØªØ¯Ø±ÙŠØ¬ÙŠ
        const cards = container.querySelectorAll('.store-card');
        cards.forEach((card, index) => {
            setTimeout(() => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.classList.add('fade-in');
                setTimeout(() => {
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, 100);
            }, index * 100);
        });
        
    } catch (error) {
        console.error('Error loading stores:', error);
        container.innerHTML = `
            <div class="col-span-3 text-center py-12">
                <div class="w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-exclamation-triangle text-2xl text-red-600"></i>
                </div>
                <h3 class="text-lg font-bold text-gray-700 mb-2">Ø­Ø¯Ø« Ø®Ø·Ø£</h3>
                <p class="text-gray-500">ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØ§Ø¬Ø±. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.</p>
                <button onclick="loadStores()" class="mt-4 text-primary hover:underline">
                    <i class="fas fa-redo ml-1"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
                </button>
            </div>
        `;
    }
}

// =============================================
// ğŸ¯ Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©
// =============================================

function showLoading(message = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...') {
    const loadingDiv = document.createElement('div');
    loadingDiv.id = 'globalLoading';
    loadingDiv.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center';
    loadingDiv.innerHTML = `
        <div class="bg-white rounded-2xl p-8 max-w-sm text-center">
            <div class="w-16 h-16 mx-auto mb-6 relative">
                <div class="absolute inset-0 bg-gradient-to-r from-primary to-purple-600 rounded-full animate-ping opacity-20"></div>
                <div class="absolute inset-2 bg-gradient-to-r from-primary to-purple-600 rounded-full flex items-center justify-center">
                    <i class="fas fa-spinner fa-spin text-white text-2xl"></i>
                </div>
            </div>
            <h3 class="text-xl font-bold text-dark mb-2">${message}</h3>
            <p class="text-gray-600">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...</p>
        </div>
    `;
    document.body.appendChild(loadingDiv);
}

function hideLoading() {
    const loading = document.getElementById('globalLoading');
    if (loading) {
        loading.style.opacity = '0';
        setTimeout(() => loading.remove(), 300);
    }
}

function getStoreGradient(category) {
    const gradients = {
        'electronics': 'from-blue-500 to-purple-600',
        'clothing': 'from-green-500 to-teal-600',
        'home': 'from-yellow-500 to-orange-600',
        'books': 'from-red-500 to-pink-600',
        'sports': 'from-indigo-500 to-blue-600',
        'beauty': 'from-pink-500 to-rose-600',
        'default': 'from-gray-500 to-gray-700'
    };
    return gradients[category] || gradients.default;
}

function getCategoryIcon(category) {
    const icons = {
        'electronics': 'fa-laptop',
        'clothing': 'fa-tshirt',
        'home': 'fa-home',
        'books': 'fa-book',
        'sports': 'fa-futbol',
        'beauty': 'fa-spa',
        'default': 'fa-store'
    };
    return icons[category] || icons.default;
}

function getDefaultStoreLogo(category) {
    const logos = {
        'electronics': 'https://cdn-icons-png.flaticon.com/512/3659/3659899.png',
        'clothing': 'https://cdn-icons-png.flaticon.com/512/3144/3144456.png',
        'home': 'https://cdn-icons-png.flaticon.com/512/2541/2541967.png',
        'books': 'https://cdn-icons-png.flaticon.com/512/2702/2702134.png',
        'sports': 'https://cdn-icons-png.flaticon.com/512/857/857455.png',
        'beauty': 'https://cdn-icons-png.flaticon.com/512/1998/1998678.png'
    };
    return logos[category] || 'https://cdn-icons-png.flaticon.com/512/891/891419.png';
}

// =============================================
// ğŸ”§ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹
// =============================================

document.addEventListener('DOMContentLoaded', function() {
    // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
    setTimeout(() => {
        document.getElementById('loadingOverlay').classList.add('opacity-0');
        setTimeout(() => {
            document.getElementById('loadingOverlay').classList.add('hidden');
            animateCounters();
        }, 300);
    }, 1000);
    
    // ØªÙ‡ÙŠØ¦Ø© Firebase
    if (firebase.apps.length === 0) {
        try {
            firebase.initializeApp(firebaseConfig);
            auth = firebase.auth();
            db = firebase.firestore();
            
            // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    currentUser = user;
                    
                    try {
                        const userDoc = await db.collection('users').doc(user.uid).get();
                        if (userDoc.exists) {
                            const userData = userDoc.data();
                            currentUserRole = userData.role || 'buyer';
                            currentUserAccountType = userData.accountType || 'buyer';
                            
                            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                            updateUIAfterLogin();
                            
                            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
                            if (window.location.hash) {
                                const section = window.location.hash.substring(1);
                                if (section && document.getElementById(section)) {
                                    navigateTo(section);
                                }
                            }
                        }
                    } catch (error) {
                        console.error('Error loading user data:', error);
                    }
                } else {
                    currentUser = null;
                    updateUIAfterLogout();
                    showContentForGuest();
                }
            });
            
        } catch (error) {
            console.error('Firebase init error:', error);
        }
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠÙ† Ù„Ù„Ø£Ø²Ø±Ø§Ø±
    setupEventListeners();
});

function setupEventListeners() {
    // Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
    document.getElementById('loginForm')?.addEventListener('submit', handleLogin);
    document.getElementById('registerForm')?.addEventListener('submit', handleRegister);
    document.getElementById('createStoreForm')?.addEventListener('submit', handleCreateStore);
    
    // Ø§Ù„Ø¨Ø­Ø«
    const searchProducts = document.getElementById('searchProducts');
    if (searchProducts) {
        searchProducts.addEventListener('keyup', debounce(function(e) {
            if (e.target.value.length > 1) {
                searchProductsFunction(e.target.value);
            } else if (e.target.value.length === 0) {
                loadProducts();
            }
        }, 300));
    }
    
    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø¨Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
    document.addEventListener('click', function(event) {
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙ†Ù‚Ù„Ø©
        const mobileMenu = document.getElementById('mobileMenu');
        const mobileMenuBtn = document.querySelector('button[onclick="toggleMobileMenu()"]');
        if (mobileMenu && !mobileMenu.contains(event.target) && 
            mobileMenuBtn && !mobileMenuBtn.contains(event.target)) {
            mobileMenu.classList.add('hidden');
        }
        
        // Ø¥ØºÙ„Ø§Ù‚ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        const userMenu = document.getElementById('userMenu');
        if (userMenu && !event.target.closest('.group')) {
            userMenu.classList.add('hidden');
        }
    });
    
    // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø¹Ù†Ø¯ Ø§Ù„Ø¸Ù‡ÙˆØ±
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('animate-fade-in');
            }
        });
    }, { threshold: 0.1 });
    
    // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
    document.querySelectorAll('.store-card, .feature-card').forEach(card => {
        observer.observe(card);
    });
}

// Ø¯Ø§Ù„Ø© Debounce Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// =============================================
// ğŸ¨ ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø¹Ø±Ø¶
// =============================================

function showContentForGuest() {
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙÙ‚Ø·
    document.querySelectorAll('main > section').forEach(section => {
        section.classList.remove('active');
        section.style.display = 'none';
    });
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    const basicSections = ['home', 'features', 'plans'];
    basicSections.forEach(sectionId => {
        const section = document.getElementById(sectionId);
        if (section) {
            section.style.display = 'block';
            setTimeout(() => section.classList.add('active'), 50);
        }
    });
}

function showContentBasedOnRole() {
    if (!currentUser) {
        showContentForGuest();
        return;
    }
    
    // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø£ÙˆÙ„Ø§Ù‹
    document.querySelectorAll('main > section').forEach(section => {
        section.classList.remove('active');
        section.style.display = 'none';
    });
    
    // Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ø´ØªØ±ÙƒØ© Ù„Ù„Ø¬Ù…ÙŠØ¹
    const commonSections = ['home', 'features', 'plans'];
    
    // Ø£Ù‚Ø³Ø§Ù… Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    if (currentUserAccountType === 'seller') {
        commonSections.push('stores', 'products', 'mainStore');
    } else if (currentUserAccountType === 'buyer') {
        commonSections.push('mainStore', 'products');
    }
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
    commonSections.forEach(sectionId => {
        const section = document.getElementById(sectionId);
        if (section) {
            section.style.display = 'block';
            setTimeout(() => section.classList.add('active'), 50);
        }
    });
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
    if (currentUserAccountType === 'seller') {
        loadStores();
        loadProducts();
    }
    loadMainStoreProducts();
}

// =============================================
// ğŸš¨ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
// =============================================

function getFirebaseErrorMessage(errorCode) {
    const messages = {
        'auth/invalid-email': 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­',
        'auth/user-disabled': 'Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…Ø¹Ø·Ù„',
        'auth/user-not-found': 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯',
        'auth/wrong-password': 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©',
        'auth/email-already-in-use': 'Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„',
        'auth/weak-password': 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ© Ø¬Ø¯Ø§Ù‹',
        'auth/network-request-failed': 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª',
        'firestore/permission-denied': 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª',
        'auth/requires-recent-login': 'ÙŠØ¬Ø¨ Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
        'auth/popup-closed-by-user': 'ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
        'auth/cancelled-popup-request': 'ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯Ø®ÙˆÙ„',
        'auth/popup-blocked': 'ØªÙ… Ø­Ø¸Ø± Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©',
        'default': 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰'
    };
    return messages[errorCode] || messages.default;
}

// =============================================
// ğŸ¬ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©
// =============================================

// Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ù…Ø§Ø· CSS Ù„Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©
const style = document.createElement('style');
style.textContent = `
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .animate-fade-in {
        animation: fadeIn 0.6s ease-out forwards;
    }
    
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    .scale-enter {
        transform: scale(0.95);
        opacity: 0;
    }
    
    .scale-enter-active {
        transform: scale(1);
        opacity: 1;
        transition: all 0.3s ease;
    }
`;
document.head.appendChild(style);
